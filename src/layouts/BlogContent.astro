---
import type { CollectionEntry } from 'astro:content'
import { buttonVariants } from '@/components/ui/button'
import { cn, formatDate } from '@/lib/utils'
import { Picture } from 'astro:assets'
import { ChevronLeft, HashIcon } from 'lucide-react'
import MainLayout from './MainLayout.astro'

type Props = CollectionEntry<'blog'>

const slug = Astro.props.slug
const { title, description, updatedDate, cover, category } = Astro.props.data;
---

<MainLayout
  title={title}
  description={description}
  bgType="default"
>
  <div class="relative container max-w-screen-md py-10">
    <button
      onclick="history.back()"
      class={cn(
        buttonVariants({ variant: 'ghost' }),
        'absolute left-[-200px] top-10 hidden xl:inline-flex text-muted-foreground',
      )}
      transition:animate="slide"
    >
      <ChevronLeft className="mr-2 size-4" />
      {' '}Back
    </button>

    <article class="prose dark:prose-invert max-w-none">
      <h1 class="text-4xl mt-4 " transition:name={`title-${slug}`}>
        {title}
      </h1>
      <div class="flex items-center font-normal space-x-4">
        <span
          class="text-ds-gray-600 text-sm mr-2"
          transition:name={`date-${slug}`}
        >
          { formatDate(updatedDate) }
        </span>
        {
          category.map((cat: string) => {
            return (
              <a
                class={cn(
                  'flex items-center justify-center space-x-[2px] group no-underline',
                  'after:!content-none hover:!no-underline',
                )}
                href={`/blog/category/${cat}`}
                transition:name={`badge-cat-${slug}`}
              >
                <HashIcon className={cn(
                  'size-3 text-ds-gray-800 hover:scale-150 duration-150 ease-in-out hover:text-ds-gray-1000',
                )}
                ></HashIcon>
                <span class="text-sm  text-ds-gray-800 link hover:text-ds-gray-1000">
                  {cat}
                </span>
              </a>
            )
          })
        }
      </div>
      <Picture
        class="rounded-xl overflow-hidden"
        width={720}
        height={360}
        src={cover}
        alt={title}
        loading="eager"
        transition:name={`img-${slug}`}
      />
      <blockquote class="mt-6 border-l-2 pl-6 font-normal text-ds-gray-700">
        {description}
      </blockquote>
      <hr class="my-6 max-w-24 mx-auto" />
      <slot />
    </article>
  </div>
</MainLayout>
